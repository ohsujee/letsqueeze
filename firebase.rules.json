{
  "rules": {
    "users": {
      "$uid": {
        ".read": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())",
        ".write": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())",
        "profile": {
          ".read": "auth != null",
          ".write": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())"
        },
        "stats": {
          ".read": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())",
          ".write": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())"
        },
        "subscription": {
          ".read": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())",
          ".write": false
        },
        "settings": {
          ".read": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())",
          ".write": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())"
        }
      }
    },
    "admins": {
      ".read": "root.child('admins').child(auth.uid).exists()",
      ".write": false
    },
    "rooms": {
      "$code": {
        ".read": "auth != null",
        "meta": {
          ".write": "auth != null && ( !data.exists() ? newData.child('hostUid').val() == auth.uid : data.child('hostUid').val() == auth.uid )",
          "teams": {
            "$teamId": {
              "score": {
                ".write": "auth != null && ( auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) )"
              }
            }
          }
        },
        "state": {
          ".read": "auth != null",
          ".write": "auth != null && ( auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) || ( !data.child('lockUid').exists() && newData.child('lockUid').val() == auth.uid && newData.child('buzz/uid').val() == auth.uid && root.child('rooms/'+$code+'/state/phase').val() == 'playing' ) )",
          "lockUid": {
            ".write": "auth != null && ( auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) || ( !data.exists() && newData.val() == auth.uid && ( root.child('rooms/'+$code+'/state/canBuzz').val() == true || root.child('rooms/'+$code+'/state/buzzer/canBuzz').val() == true || root.child('rooms/'+$code+'/state/isBuzzArmed').val() == true || root.child('rooms/'+$code+'/state/can_buzz').val() == true || root.child('rooms/'+$code+'/state/buzzEnabled').val() == true || root.child('rooms/'+$code+'/state/armed').val() == true || root.child('rooms/'+$code+'/state/revealed').val() == true || root.child('rooms/'+$code+'/state/question/revealed').val() == true || root.child('rooms/'+$code+'/state/phase').val() == 'playing' ) ) )"
          },
          "buzzBanner": {
            ".write": "auth != null && ( auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) || root.child('rooms/'+$code+'/state/lockUid').val() == auth.uid )"
          },
          "buzz": {
            ".write": "auth != null && ( auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) || ( ( !root.child('rooms/'+$code+'/state/lockUid').exists() || root.child('rooms/'+$code+'/state/lockUid').val() == auth.uid ) && newData.hasChildren(['uid','at']) && newData.child('uid').val() == auth.uid ) )",
            ".validate": "newData.hasChildren(['uid','at']) && (auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) || newData.child('uid').val() == auth.uid) && (!newData.hasChild('anticipated') || newData.child('anticipated').isBoolean())"
          },
          "pausedAt": {
            ".write": "auth != null && ( auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) )"
          },
          "lockedAt": {
            ".write": "auth != null && ( auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) )"
          },
          "pendingBuzzes": {
            "$uid": {
              ".write": "auth != null && (auth.uid == $uid || auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() )) && (root.child('rooms/'+$code+'/state/phase').val() == 'playing' || auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ))",
              ".validate": "newData.hasChildren(['uid','adjustedTime']) && newData.child('uid').val() == auth.uid"
            }
          }
        },
        "players": {
          "$uid": {
            ".write": "auth != null && ( auth.uid == $uid || auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) )"
          },
          ".read": "auth != null"
        },
        "presence": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && auth.uid == $uid"
          }
        },
        "kickedPlayers": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val()"
          }
        },
        "history": {
          ".write": "auth != null && ( auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) )"
        },
        "__health__": {
          ".write": "auth != null && auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val()"
        },
        "flags": {
          ".write": "auth != null && auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val()"
        },
        "quiz": {
          ".write": "auth != null && ( auth.uid == root.child('rooms/'+$code+'/meta/hostUid').val() || ( root.child('rooms/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms/'+$code+'/state/currentAskerUid').val() ) )"
        }
      }
    },
    "rooms_alibi": {
      "$code": {
        ".read": "auth != null",
        ".write": "auth != null && auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val()",
        "meta": {
          ".write": "auth != null && ( !data.exists() ? newData.child('hostUid').val() == auth.uid : data.child('hostUid').val() == auth.uid )"
        },
        "state": {
          ".read": "auth != null",
          ".write": "auth != null && ( auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val() || ( root.child('rooms_alibi/'+$code+'/meta/gameMasterMode').val() == 'party' && root.child('rooms_alibi/'+$code+'/players/'+auth.uid+'/groupId').val() == root.child('rooms_alibi/'+$code+'/state/inspectorGroupId').val() ) )"
        },
        "teams": {
          ".read": "auth != null",
          ".write": "auth != null && auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val()"
        },
        "groups": {
          ".read": "auth != null",
          "$groupId": {
            ".write": "auth != null && auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val()",
            "name": {
              ".write": "auth != null && ( auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val() || root.child('rooms_alibi/'+$code+'/players/'+auth.uid+'/groupId').val() == $groupId )"
            },
            "score": {
              ".write": "auth != null && ( auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val() || ( root.child('rooms_alibi/'+$code+'/meta/gameMasterMode').val() == 'party' && root.child('rooms_alibi/'+$code+'/players/'+auth.uid+'/groupId').val() == root.child('rooms_alibi/'+$code+'/state/inspectorGroupId').val() ) )"
            }
          }
        },
        "score": {
          ".read": "auth != null",
          ".write": "auth != null && ( auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val() || ( root.child('rooms_alibi/'+$code+'/meta/gameMasterMode').val() == 'party' && root.child('rooms_alibi/'+$code+'/players/'+auth.uid+'/groupId').val() == root.child('rooms_alibi/'+$code+'/state/inspectorGroupId').val() ) )"
        },
        "alibi": {
          ".read": "auth != null",
          ".write": "auth != null && auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val()"
        },
        "questions": {
          ".read": "auth != null",
          ".write": "auth != null && auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val()"
        },
        "interrogation": {
          ".read": "auth != null",
          ".write": "auth != null && ( auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val() || ( root.child('rooms_alibi/'+$code+'/meta/gameMasterMode').val() == 'party' && root.child('rooms_alibi/'+$code+'/players/'+auth.uid+'/groupId').val() == root.child('rooms_alibi/'+$code+'/state/inspectorGroupId').val() ) )",
          "responses": {
            "$uid": {
              ".write": "auth != null && ( auth.uid == $uid || ( root.child('rooms_alibi/'+$code+'/meta/gameMasterMode').val() == 'party' && root.child('rooms_alibi/'+$code+'/players/'+auth.uid+'/groupId').val() == root.child('rooms_alibi/'+$code+'/state/accusedGroupId').val() && auth.uid == $uid ) )"
            }
          }
        },
        "answers": {
          ".read": "auth != null",
          "$visibleTo": {
            "$visibleFrom": {
              ".write": "auth != null && (auth.uid == $visibleFrom || auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val())",
              ".validate": "newData.isString() && newData.val().length <= 500"
            }
          }
        },
        "players": {
          "$uid": {
            ".write": "auth != null && ( auth.uid == $uid || auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val() )"
          },
          ".read": "auth != null"
        },
        "presence": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && auth.uid == $uid"
          }
        },
        "kickedPlayers": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && auth.uid == root.child('rooms_alibi/'+$code+'/meta/hostUid').val()"
          }
        }
      }
    },
    "rooms_blindtest": {
      "$code": {
        ".read": "auth != null",
        "meta": {
          ".write": "auth != null && ( !data.exists() ? newData.child('hostUid').val() == auth.uid : data.child('hostUid').val() == auth.uid )",
          "teams": {
            "$teamId": {
              "score": {
                ".write": "auth != null && ( auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) )"
              }
            }
          },
          "playlist": {
            ".validate": "newData.hasChildren(['id', 'name'])",
            "tracks": {
              ".write": "auth != null && ( auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) )"
            }
          },
          "playlistsUsed": {
            ".validate": "newData.isNumber()"
          }
        },
        "state": {
          ".read": "auth != null",
          ".write": "auth != null && ( auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) || ( !data.child('lockUid').exists() && newData.child('lockUid').val() == auth.uid && newData.child('buzz/uid').val() == auth.uid && root.child('rooms_blindtest/'+$code+'/state/phase').val() == 'playing' ) )",
          "lockUid": {
            ".write": "auth != null && ( auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) || ( !data.exists() && newData.val() == auth.uid && root.child('rooms_blindtest/'+$code+'/state/phase').val() == 'playing' ) )"
          },
          "buzzBanner": {
            ".write": "auth != null && ( auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) || root.child('rooms_blindtest/'+$code+'/state/lockUid').val() == auth.uid )"
          },
          "buzz": {
            ".write": "auth != null && ( auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) || ( ( !root.child('rooms_blindtest/'+$code+'/state/lockUid').exists() || root.child('rooms_blindtest/'+$code+'/state/lockUid').val() == auth.uid ) && newData.hasChildren(['uid','at']) && newData.child('uid').val() == auth.uid ) )",
            ".validate": "newData.hasChildren(['uid','at']) && (auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) || newData.child('uid').val() == auth.uid)"
          },
          "pausedAt": {
            ".write": "auth != null && ( auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) )"
          },
          "lockedAt": {
            ".write": "auth != null && ( auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) )"
          },
          "pendingBuzzes": {
            "$uid": {
              ".write": "auth != null && (auth.uid == $uid || auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() )) && (root.child('rooms_blindtest/'+$code+'/state/phase').val() == 'playing' || auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ))",
              ".validate": "newData.hasChildren(['uid','adjustedTime']) && newData.child('uid').val() == auth.uid"
            }
          }
        },
        "players": {
          "$uid": {
            ".write": "auth != null && ( auth.uid == $uid || auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) )"
          },
          ".read": "auth != null"
        },
        "presence": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && auth.uid == $uid"
          }
        },
        "kickedPlayers": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val()"
          }
        },
        "tracks": {
          ".read": "auth != null",
          ".write": "auth != null && ( auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) )"
        },
        "history": {
          ".write": "auth != null && ( auth.uid == root.child('rooms_blindtest/'+$code+'/meta/hostUid').val() || ( root.child('rooms_blindtest/'+$code+'/meta/gameMasterMode').val() == 'party' && auth.uid == root.child('rooms_blindtest/'+$code+'/state/currentAskerUid').val() ) )"
        }
      }
    },
    "rooms_laregle": {
      "$code": {
        ".read": "auth != null",
        ".write": "auth != null && auth.uid == root.child('rooms_laregle/'+$code+'/meta/hostUid').val()",
        "meta": {
          ".write": "auth != null && ( !data.exists() ? newData.child('hostUid').val() == auth.uid : data.child('hostUid').val() == auth.uid )"
        },
        "state": {
          ".read": "auth != null",
          ".write": "auth != null && auth.uid == root.child('rooms_laregle/'+$code+'/meta/hostUid').val()",
          "votes": {
            "$uid": {
              ".write": "auth != null && auth.uid == $uid"
            }
          },
          "guessVotes": {
            "$uid": {
              ".write": "auth != null && auth.uid == $uid"
            }
          }
        },
        "players": {
          "$uid": {
            ".write": "auth != null && ( auth.uid == $uid || auth.uid == root.child('rooms_laregle/'+$code+'/meta/hostUid').val() )"
          },
          ".read": "auth != null"
        },
        "presence": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && auth.uid == $uid"
          }
        },
        "kickedPlayers": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && auth.uid == root.child('rooms_laregle/'+$code+'/meta/hostUid').val()"
          }
        }
      }
    },
    "rooms_mime": {
      "$code": {
        ".read": "auth != null",
        "meta": {
          ".write": "auth != null && ( !data.exists() ? newData.child('hostUid').val() == auth.uid : data.child('hostUid').val() == auth.uid )"
        },
        "state": {
          ".read": "auth != null",
          ".write": "auth != null && ( auth.uid == root.child('rooms_mime/'+$code+'/meta/hostUid').val() || auth.uid == root.child('rooms_mime/'+$code+'/state/currentMimeUid').val() )",
          "lockUid": {
            ".write": "auth != null && ( auth.uid == root.child('rooms_mime/'+$code+'/meta/hostUid').val() || auth.uid == root.child('rooms_mime/'+$code+'/state/currentMimeUid').val() || ( !data.exists() && newData.val() == auth.uid && root.child('rooms_mime/'+$code+'/state/phase').val() == 'playing' && root.child('rooms_mime/'+$code+'/state/revealed').val() == true ) )"
          },
          "buzzBanner": {
            ".write": "auth != null && ( auth.uid == root.child('rooms_mime/'+$code+'/meta/hostUid').val() || auth.uid == root.child('rooms_mime/'+$code+'/state/currentMimeUid').val() || root.child('rooms_mime/'+$code+'/state/lockUid').val() == auth.uid )"
          },
          "pendingBuzzes": {
            "$uid": {
              ".write": "auth != null && (auth.uid == $uid || auth.uid == root.child('rooms_mime/'+$code+'/meta/hostUid').val() || auth.uid == root.child('rooms_mime/'+$code+'/state/currentMimeUid').val()) && (root.child('rooms_mime/'+$code+'/state/phase').val() == 'playing' || auth.uid == root.child('rooms_mime/'+$code+'/meta/hostUid').val() || auth.uid == root.child('rooms_mime/'+$code+'/state/currentMimeUid').val())",
              ".validate": "newData.hasChildren(['uid','adjustedTime']) && newData.child('uid').val() == auth.uid"
            }
          }
        },
        "players": {
          "$uid": {
            ".write": "auth != null && ( auth.uid == $uid || auth.uid == root.child('rooms_mime/'+$code+'/meta/hostUid').val() || auth.uid == root.child('rooms_mime/'+$code+'/state/currentMimeUid').val() )"
          },
          ".read": "auth != null"
        },
        "presence": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && auth.uid == $uid"
          }
        },
        "kickedPlayers": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && auth.uid == root.child('rooms_mime/'+$code+'/meta/hostUid').val()"
          }
        },
        "words": {
          ".read": "auth != null",
          ".write": "auth != null && auth.uid == root.child('rooms_mime/'+$code+'/meta/hostUid').val()"
        }
      }
    },
    "mime_themes": {
      ".read": "auth != null",
      "$themeId": {
        ".write": "root.child('admins').child(auth.uid).exists()"
      }
    },
    "stats": {
      "globalPlayCounts": {
        ".read": true,
        "$gameId": {
          ".write": "auth != null"
        }
      }
    },
    "daily": {
      "wordle": {
        "schedule": {
          ".read": true,
          ".write": "root.child('admins').child(auth.uid).exists()"
        },
        "$date": {
          "word": {
            ".read": true,
            ".write": "root.child('admins').child(auth.uid).exists()"
          },
          "word_length": {
            ".read": true,
            ".write": "root.child('admins').child(auth.uid).exists()"
          },
          "leaderboard": {
            ".read": "auth != null",
            "$uid": {
              ".write": "auth != null && auth.uid == $uid",
              ".validate": "newData.hasChildren(['attempts', 'solved', 'name']) && newData.child('attempts').isNumber() && newData.child('solved').isBoolean()"
            }
          }
        }
      },
      "semantic": {
        "$date": {
          "storage_path": {
            ".read": "auth != null",
            ".write": "root.child('admins').child(auth.uid).exists()"
          },
          "leaderboard": {
            ".read": "auth != null",
            "$uid": {
              ".write": "auth != null && auth.uid == $uid",
              ".validate": "newData.hasChildren(['attempts', 'solved', 'name']) && newData.child('attempts').isNumber() && newData.child('solved').isBoolean()"
            }
          }
        }
      }
    }
  }
}
